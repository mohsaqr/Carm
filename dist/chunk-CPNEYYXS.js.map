{
  "version": 3,
  "sources": ["../src/core/math.ts", "../src/core/apa.ts"],
  "sourcesContent": ["/**\n * Core mathematical utilities for Carm.\n * Beta/Gamma functions, Nelder-Mead optimizer, p-value adjustment.\n * All pure functions \u2014 no DOM, no side effects.\n */\n\nimport type { PAdjMethod } from './types.js'\n\n// \u2500\u2500\u2500 Gamma / Beta functions \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/**\n * Natural log of the Gamma function via Lanczos approximation.\n * Reference: Press et al., \"Numerical Recipes in C\", 3rd ed., \u00A76.1\n */\nexport function logGamma(z: number): number {\n  if (z <= 0) throw new Error(`logGamma: z must be positive, got ${z}`)\n  if (z < 0.5) {\n    // Reflection formula: \u0393(z)\u0393(1-z) = \u03C0/sin(\u03C0z)\n    return Math.log(Math.PI / Math.sin(Math.PI * z)) - logGamma(1 - z)\n  }\n  const g = 7\n  const c = [\n    0.99999999999980993,\n    676.5203681218851,\n    -1259.1392167224028,\n    771.32342877765313,\n    -176.61502916214059,\n    12.507343278686905,\n    -0.13857109526572012,\n    9.9843695780195716e-6,\n    1.5056327351493116e-7,\n  ]\n  const x = z - 1\n  let sum = c[0]!\n  for (let i = 1; i < g + 2; i++) sum += (c[i] ?? 0) / (x + i)\n  const t = x + g + 0.5\n  return 0.5 * Math.log(2 * Math.PI) + (x + 0.5) * Math.log(t) - t + Math.log(sum)\n}\n\n/** Gamma function. */\nexport function gamma(z: number): number {\n  return Math.exp(logGamma(z))\n}\n\n/** Log of Beta function: log B(a, b) = log\u0393(a) + log\u0393(b) - log\u0393(a+b). */\nexport function logBeta(a: number, b: number): number {\n  return logGamma(a) + logGamma(b) - logGamma(a + b)\n}\n\n/** Beta function. */\nexport function betaFn(a: number, b: number): number {\n  return Math.exp(logBeta(a, b))\n}\n\n/**\n * Regularized incomplete beta function I_x(a, b) via continued fraction.\n * Used for t, F, and beta distribution CDFs.\n * Reference: Press et al., \u00A76.4 (Lentz continued fraction algorithm)\n */\nexport function incompleteBeta(x: number, a: number, b: number): number {\n  if (x < 0 || x > 1) throw new Error(`incompleteBeta: x must be in [0,1], got ${x}`)\n  if (x === 0) return 0\n  if (x === 1) return 1\n\n  // Use symmetry when x > (a+1)/(a+b+2) for faster convergence\n  if (x > (a + 1) / (a + b + 2)) {\n    return 1 - incompleteBeta(1 - x, b, a)\n  }\n\n  const lbeta_ab = logBeta(a, b)\n  const front = Math.exp(Math.log(x) * a + Math.log(1 - x) * b - lbeta_ab) / a\n\n  // Lentz continued fraction\n  const MAX_ITER = 200\n  const EPS = 3e-7\n  const FPMIN = 1e-30\n\n  let f = 1\n  let C = 1\n  let D = 1 - (a + b) * x / (a + 1)\n  if (Math.abs(D) < FPMIN) D = FPMIN\n  D = 1 / D\n  f = D\n\n  for (let m = 1; m <= MAX_ITER; m++) {\n    // Even step\n    let num = m * (b - m) * x / ((a + 2 * m - 1) * (a + 2 * m))\n    D = 1 + num * D\n    if (Math.abs(D) < FPMIN) D = FPMIN\n    C = 1 + num / C\n    if (Math.abs(C) < FPMIN) C = FPMIN\n    D = 1 / D\n    f *= C * D\n\n    // Odd step\n    num = -(a + m) * (a + b + m) * x / ((a + 2 * m) * (a + 2 * m + 1))\n    D = 1 + num * D\n    if (Math.abs(D) < FPMIN) D = FPMIN\n    C = 1 + num / C\n    if (Math.abs(C) < FPMIN) C = FPMIN\n    D = 1 / D\n    const delta = C * D\n    f *= delta\n\n    if (Math.abs(delta - 1) < EPS) break\n  }\n  return front * f\n}\n\n/**\n * Regularized incomplete gamma function P(a, x) via series expansion.\n * Used for chi-square and Poisson CDFs.\n * Reference: Press et al., \u00A76.2\n */\nexport function incompleteGamma(a: number, x: number): number {\n  if (x < 0) throw new Error(`incompleteGamma: x must be \u2265 0, got ${x}`)\n  if (x === 0) return 0\n\n  if (x < a + 1) {\n    // Series representation\n    let term = 1 / a\n    let sum = term\n    for (let n = 1; n < 200; n++) {\n      term *= x / (a + n)\n      sum += term\n      if (Math.abs(term) < Math.abs(sum) * 3e-7) break\n    }\n    return sum * Math.exp(-x + a * Math.log(x) - logGamma(a))\n  } else {\n    // Continued fraction (complement)\n    return 1 - incompleteGammaComplement(a, x)\n  }\n}\n\nfunction incompleteGammaComplement(a: number, x: number): number {\n  // Lentz continued fraction for Q(a,x)\n  const FPMIN = 1e-30\n  let f = x + 1 - a\n  if (Math.abs(f) < FPMIN) f = FPMIN\n  let C = f, D = 0\n  for (let i = 1; i <= 200; i++) {\n    const an = -i * (i - a)\n    const bn = x + 2 * i + 1 - a\n    D = bn + an * D\n    if (Math.abs(D) < FPMIN) D = FPMIN\n    C = bn + an / C\n    if (Math.abs(C) < FPMIN) C = FPMIN\n    D = 1 / D\n    const delta = C * D\n    f *= delta\n    if (Math.abs(delta - 1) < 3e-7) break\n  }\n  return Math.exp(-x + a * Math.log(x) - logGamma(a)) / f\n}\n\n// \u2500\u2500\u2500 t-distribution CDF \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/** Two-tailed p-value from t statistic with df degrees of freedom. */\nexport function tDistPValue(t: number, df: number): number {\n  const x = df / (df + t * t)\n  const p = incompleteBeta(x, df / 2, 0.5)\n  return p  // already two-tailed\n}\n\n/** CDF of t-distribution P(T \u2264 t | df). */\nexport function tDistCDF(t: number, df: number): number {\n  const x = df / (df + t * t)\n  const p = 0.5 * incompleteBeta(x, df / 2, 0.5)\n  return t >= 0 ? 1 - p : p\n}\n\n/** Quantile (inverse CDF) of t-distribution. Uses bisection. */\nexport function tDistQuantile(p: number, df: number): number {\n  if (p <= 0 || p >= 1) throw new Error(`tDistQuantile: p must be in (0,1), got ${p}`)\n  // Bisection on CDF\n  let lo = -50, hi = 50\n  for (let i = 0; i < 100; i++) {\n    const mid = (lo + hi) / 2\n    if (tDistCDF(mid, df) < p) lo = mid\n    else hi = mid\n    if (hi - lo < 1e-10) break\n  }\n  return (lo + hi) / 2\n}\n\n// \u2500\u2500\u2500 F-distribution CDF \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/** P(F \u2264 f | df1, df2) via regularized incomplete beta. */\nexport function fDistCDF(f: number, df1: number, df2: number): number {\n  if (f <= 0) return 0\n  const x = df1 * f / (df1 * f + df2)\n  return incompleteBeta(x, df1 / 2, df2 / 2)\n}\n\n/** Upper tail p-value for F-distribution. */\nexport function fDistPValue(f: number, df1: number, df2: number): number {\n  return 1 - fDistCDF(f, df1, df2)\n}\n\n// \u2500\u2500\u2500 Chi-square distribution \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/** P(\u03C7\u00B2 \u2264 x | df). */\nexport function chiSqCDF(x: number, df: number): number {\n  if (x <= 0) return 0\n  return incompleteGamma(df / 2, x / 2)\n}\n\n/** Upper tail p-value for chi-square. */\nexport function chiSqPValue(x: number, df: number): number {\n  return 1 - chiSqCDF(x, df)\n}\n\n/** Quantile of chi-square distribution via bisection. */\nexport function chiSqQuantile(p: number, df: number): number {\n  if (p <= 0) return 0\n  if (p >= 1) return Infinity\n  let lo = 0, hi = df + 10 * Math.sqrt(2 * df)\n  for (let i = 0; i < 100; i++) {\n    const mid = (lo + hi) / 2\n    if (chiSqCDF(mid, df) < p) lo = mid\n    else hi = mid\n    if (hi - lo < 1e-10) break\n  }\n  return (lo + hi) / 2\n}\n\n// \u2500\u2500\u2500 Normal distribution \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/** Standard normal CDF using complementary error function. */\nexport function normalCDF(z: number): number {\n  return 0.5 * (1 + erf(z / Math.SQRT2))\n}\n\n/**\n * Upper-tail probability P(Z > z) \u2014 numerically stable for large z.\n * Uses erfc directly to avoid catastrophic cancellation in `1 - normalCDF(z)`.\n * Matches R's `pnorm(z, lower.tail = FALSE)`.\n */\nexport function normalSurvival(z: number): number {\n  if (z >= 0) {\n    // P(Z > z) = 0.5 * erfc(z / sqrt(2))\n    return 0.5 * erfc(z / Math.SQRT2)\n  }\n  // P(Z > z) for z < 0: use symmetry = 1 - 0.5*erfc(-z/sqrt(2))\n  return 1 - 0.5 * erfc(-z / Math.SQRT2)\n}\n\n// \u2500\u2500\u2500 Exact distribution functions for rank correlations \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/**\n * Exact CDF of Kendall's tau concordance count: P(T \u2264 q).\n * T = number of concordant pairs in a permutation of n elements.\n * Uses recursive DP with memoization (R's kendall.c algorithm, Best & Gipps 1974).\n * Only valid for n < 50 (no ties). Falls back to normal approximation otherwise.\n */\nexport function pKendallExact(q: number, n: number): number {\n  q = Math.floor(q + 1e-7)\n  const maxT = n * (n - 1) / 2\n  if (q < 0) return 0\n  if (q > maxT) return 1\n\n  // ckendall(k, nn): number of permutations of nn elements with exactly k concordant pairs\n  const cache = new Map<number, Float64Array>()\n  function ckendall(k: number, nn: number): number {\n    const u = nn * (nn - 1) / 2\n    if (k < 0 || k > u) return 0\n    if (nn === 1) return k === 0 ? 1 : 0\n\n    if (!cache.has(nn)) {\n      const arr = new Float64Array(u + 1)\n      for (let i = 0; i <= u; i++) arr[i] = -1\n      cache.set(nn, arr)\n    }\n    const w = cache.get(nn)!\n    if (w[k]! < 0) {\n      let s = 0\n      for (let i = 0; i < nn; i++) s += ckendall(k - i, nn - 1)\n      w[k] = s\n    }\n    return w[k]!\n  }\n\n  let p = 0\n  for (let j = 0; j <= q; j++) p += ckendall(j, n)\n\n  // Divide by n!\n  let nfact = 1\n  for (let i = 2; i <= n; i++) nfact *= i\n  return p / nfact\n}\n\n/**\n * Exact/Edgeworth CDF for Spearman's rho statistic D = \u03A3(d_i\u00B2).\n * For n \u2264 9: exact enumeration of all n! permutations (AS89).\n * For n > 9: Edgeworth series expansion (AS89 large-n approximation).\n * Reference: Best & Roberts (1975), R's prho.c\n *\n * @param D - Sum of squared rank differences \u03A3(rank_x_i - rank_y_i)\u00B2\n * @param n - Sample size\n * @param lowerTail - If true, returns P(D' \u2264 D); if false, P(D' \u2265 D)\n */\nexport function pSpearmanExact(D: number, n: number, lowerTail: boolean): number {\n  const n3 = n * (n * n - 1) / 3 // max possible D\n\n  if (n <= 1) return lowerTail ? 0 : 1\n  if (D <= 0) return lowerTail ? 0 : 1\n  if (D > n3) return lowerTail ? 1 : 0\n\n  if (n <= 9) {\n    // Exact enumeration \u2014 generate all n! permutations\n    const perm = new Array<number>(n)\n    for (let i = 0; i < n; i++) perm[i] = i + 1\n\n    let nfac = 1\n    for (let i = 1; i <= n; i++) nfac *= i\n\n    let ifr = 0 // count of perms where D' \u2265 D\n    // Use the same permutation algorithm as R's prho.c\n    for (let m = 0; m < nfac; m++) {\n      // Compute sum of squared differences for current permutation\n      let ise = 0\n      for (let i = 0; i < n; i++) {\n        const d = i + 1 - perm[i]!\n        ise += d * d\n      }\n      if (D <= ise) ifr++\n\n      // Advance to next permutation (R's cyclic rotation method)\n      let n1 = n\n      do {\n        const mt = perm[0]!\n        for (let i = 1; i < n1; i++) perm[i - 1] = perm[i]!\n        n1--\n        perm[n1] = mt\n        if (mt !== n1 + 1 || n1 <= 1) break\n      } while (true)\n    }\n\n    return (lowerTail ? nfac - ifr : ifr) / nfac\n  }\n\n  // Edgeworth series expansion for n > 9 (from R's prho.c, AS89)\n  const c1 = 0.2274, c2 = 0.2531, c3 = 0.1745, c4 = 0.0758\n  const c5 = 0.1033, c6 = 0.3932, c7 = 0.0879, c8 = 0.0151\n  const c9 = 0.0072, c10 = 0.0831, c11 = 0.0131, c12 = 4.6e-4\n\n  const yn = n\n  const b = 1 / yn\n  const x = (6 * (D - 1) * b / (yn * yn - 1) - 1) * Math.sqrt(yn - 1)\n  let y = x * x\n  const u = x * b * (c1 + b * (c2 + c3 * b) +\n    y * (-c4 + b * (c5 + c6 * b) -\n      y * b * (c7 + c8 * b -\n        y * (c9 - c10 * b + y * b * (c11 - c12 * y)))))\n  y = x * x // restore y\n  const correction = u / Math.exp(y / 2)\n\n  // pnorm(x, lower_tail) + correction\n  let pv: number\n  if (lowerTail) {\n    pv = -correction + normalCDF(x)\n  } else {\n    pv = correction + normalSurvival(x)\n  }\n  if (pv < 0) pv = 0\n  if (pv > 1) pv = 1\n  return pv\n}\n\n/**\n * Inverse standard normal CDF (quantile function).\n * Peter Acklam's rational approximation \u2014 max absolute error ~1.15e-9.\n * Reference: https://web.archive.org/web/20151030215612/http://home.online.no/~pjacklam/notes/invnorm/\n */\nexport function normalQuantile(p: number): number {\n  if (p <= 0 || p >= 1) throw new Error(`normalQuantile: p must be in (0,1), got ${p}`)\n\n  // Coefficients for the rational approximations\n  const a1 = -3.969683028665376e+01, a2 =  2.209460984245205e+02\n  const a3 = -2.759285104469687e+02, a4 =  1.383577518672690e+02\n  const a5 = -3.066479806614716e+01, a6 =  2.506628277459239e+00\n  const b1 = -5.447609879822406e+01, b2 =  1.615858368580409e+02\n  const b3 = -1.556989798598866e+02, b4 =  6.680131188771972e+01\n  const b5 = -1.328068155288572e+01\n  const c1 = -7.784894002430293e-03, c2 = -3.223964580411365e-01\n  const c3 = -2.400758277161838e+00, c4 = -2.549732539343734e+00\n  const c5 =  4.374664141464968e+00, c6 =  2.938163982698783e+00\n  const d1 =  7.784695709041462e-03, d2 =  3.224671290700398e-01\n  const d3 =  2.445134137142996e+00, d4 =  3.754408661907416e+00\n\n  const pLow = 0.02425, pHigh = 1 - pLow\n\n  if (p < pLow) {\n    // Lower tail region\n    const q = Math.sqrt(-2 * Math.log(p))\n    return (((((c1*q+c2)*q+c3)*q+c4)*q+c5)*q+c6) /\n           ((((d1*q+d2)*q+d3)*q+d4)*q+1)\n  } else if (p <= pHigh) {\n    // Central region\n    const q = p - 0.5, r = q * q\n    return (((((a1*r+a2)*r+a3)*r+a4)*r+a5)*r+a6)*q /\n           (((((b1*r+b2)*r+b3)*r+b4)*r+b5)*r+1)\n  } else {\n    // Upper tail region (mirror of lower)\n    const q = Math.sqrt(-2 * Math.log(1 - p))\n    return -(((((c1*q+c2)*q+c3)*q+c4)*q+c5)*q+c6) /\n            ((((d1*q+d2)*q+d3)*q+d4)*q+1)\n  }\n}\n\n/** Error function approximation (Horner's method). */\nfunction erf(x: number): number {\n  // Abramowitz & Stegun formula 7.1.26\n  const t = 1 / (1 + 0.3275911 * Math.abs(x))\n  const poly = t * (0.254829592 + t * (-0.284496736 + t * (1.421413741 + t * (-1.453152027 + t * 1.061405429))))\n  const result = 1 - poly * Math.exp(-x * x)\n  return x >= 0 ? result : -result\n}\n\n/** Complementary error function erfc(x) = 1 - erf(x), stable for large x. */\nfunction erfc(x: number): number {\n  // For x >= 0: erfc(x) = poly * exp(-x\u00B2), directly from A&S 7.1.26\n  const ax = Math.abs(x)\n  const t = 1 / (1 + 0.3275911 * ax)\n  const poly = t * (0.254829592 + t * (-0.284496736 + t * (1.421413741 + t * (-1.453152027 + t * 1.061405429))))\n  const val = poly * Math.exp(-ax * ax)\n  return x >= 0 ? val : 2 - val\n}\n\n// \u2500\u2500\u2500 Nelder-Mead Optimizer \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nexport interface NelderMeadOptions {\n  readonly maxIter?: number\n  readonly tol?: number\n  readonly alpha?: number   // reflection\n  readonly beta?: number    // contraction\n  readonly gamma?: number   // expansion\n  readonly delta?: number   // shrink\n}\n\nexport interface NelderMeadResult {\n  readonly x: readonly number[]\n  readonly fval: number\n  readonly iterations: number\n  readonly converged: boolean\n}\n\n/**\n * Nelder-Mead simplex optimizer for unconstrained minimization.\n * Reference: Nelder & Mead (1965), The Computer Journal 7(4):308-313\n */\nexport function nelderMead(\n  fn: (x: readonly number[]) => number,\n  x0: readonly number[],\n  opts: NelderMeadOptions = {}\n): NelderMeadResult {\n  const n = x0.length\n  const maxIter = opts.maxIter ?? 1000 * n\n  const tol = opts.tol ?? 1e-8\n  const alpha = opts.alpha ?? 1.0\n  const beta = opts.beta ?? 0.5\n  const gam = opts.gamma ?? 2.0\n  const delta = opts.delta ?? 0.5\n\n  // Initialize simplex: n+1 vertices\n  const simplex: number[][] = Array.from({ length: n + 1 }, (_, i) => {\n    const v = [...x0]\n    if (i > 0) v[i - 1] = (v[i - 1] ?? 0) + ((Math.abs(v[i - 1] ?? 0) > 1e-8) ? 0.05 * (v[i - 1] ?? 0) : 0.00025)\n    return v\n  })\n  let fvals = simplex.map(v => fn(v))\n\n  let iter = 0\n  let converged = false\n\n  for (; iter < maxIter; iter++) {\n    // Sort by function value and keep simplex in sync\n    const order = fvals.map((_, i) => i).sort((a, b) => fvals[a]! - fvals[b]!)\n    const sorted = order.map(i => simplex[i]!)\n    fvals = order.map(i => fvals[i]!)\n    // Critical: sync simplex so simplex[i] corresponds to fvals[i]\n    for (let i = 0; i <= n; i++) simplex[i] = sorted[i]!\n\n    // Check convergence\n    const fRange = (fvals[n] ?? 0) - (fvals[0] ?? 0)\n    if (fRange < tol) { converged = true; break }\n\n    // Centroid of all but worst (simplex[n] is now the worst)\n    const centroid = Array.from({ length: n }, (_, j) =>\n      simplex.slice(0, n).reduce((s, v) => s + (v[j] ?? 0), 0) / n\n    )\n\n    // Reflect worst\n    const worst = simplex[n]!\n    const reflected = centroid.map((c, j) => c + alpha * (c - (worst[j] ?? 0)))\n    const fr = fn(reflected)\n\n    if (fr < (fvals[0] ?? 0)) {\n      // Expansion\n      const expanded = centroid.map((c, j) => c + gam * (reflected[j]! - c))\n      const fe = fn(expanded)\n      simplex[n] = fe < fr ? expanded : reflected\n      fvals[n] = fe < fr ? fe : fr\n    } else if (fr < (fvals[n - 1] ?? 0)) {\n      simplex[n] = reflected\n      fvals[n] = fr\n    } else {\n      // Contraction\n      const contracted = centroid.map((c, j) => c + beta * ((worst[j] ?? 0) - c))\n      const fc = fn(contracted)\n      if (fc < (fvals[n] ?? 0)) {\n        simplex[n] = contracted\n        fvals[n] = fc\n      } else {\n        // Shrink toward best (simplex[0])\n        const best = simplex[0]!\n        for (let i = 1; i <= n; i++) {\n          simplex[i] = simplex[i]!.map((v, j) => (best[j] ?? 0) + delta * (v - (best[j] ?? 0)))\n          fvals[i] = fn(simplex[i]!)\n        }\n      }\n    }\n  }\n\n  const order0 = fvals.map((_, i) => i).sort((a, b) => fvals[a]! - fvals[b]!)\n  return {\n    x: simplex[order0[0]!]!,\n    fval: fvals[order0[0]!]!,\n    iterations: iter,\n    converged,\n  }\n}\n\n// \u2500\u2500\u2500 P-value adjustment \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/**\n * Adjust p-values for multiple comparisons.\n * Methods: 'bonferroni', 'holm', 'BH' (Benjamini-Hochberg), 'BY', 'none'.\n * Reference: R stats::p.adjust\n */\nexport function adjustPValues(pValues: readonly number[], method: PAdjMethod): number[] {\n  const n = pValues.length\n  if (n === 0) return []\n  if (method === 'none') return [...pValues]\n\n  if (method === 'bonferroni') {\n    return pValues.map(p => Math.min(1, p * n))\n  }\n\n  if (method === 'holm') {\n    const order = pValues.map((p, i) => ({ p, i })).sort((a, b) => a.p - b.p)\n    const adj = new Array<number>(n)\n    let running = 0\n    for (let k = 0; k < n; k++) {\n      const { p, i } = order[k]!\n      running = Math.max(running, p * (n - k))\n      adj[i] = Math.min(1, running)\n    }\n    return adj\n  }\n\n  if (method === 'BH') {\n    // Benjamini-Hochberg\n    const order = pValues.map((p, i) => ({ p, i })).sort((a, b) => b.p - a.p) // descending\n    const adj = new Array<number>(n)\n    let minSoFar = Infinity\n    for (let k = 0; k < n; k++) {\n      const { p, i } = order[k]!\n      const rank = n - k  // rank from smallest (1-indexed)\n      const adjusted = p * n / rank\n      minSoFar = Math.min(minSoFar, adjusted)\n      adj[i] = Math.min(1, minSoFar)\n    }\n    return adj\n  }\n\n  if (method === 'BY') {\n    // Benjamini-Yekutieli\n    const cm = pValues.reduce((s, _, k) => s + 1 / (k + 1), 0)\n    const order = pValues.map((p, i) => ({ p, i })).sort((a, b) => b.p - a.p)\n    const adj = new Array<number>(n)\n    let minSoFar = Infinity\n    for (let k = 0; k < n; k++) {\n      const { p, i } = order[k]!\n      const rank = n - k\n      const adjusted = p * n * cm / rank\n      minSoFar = Math.min(minSoFar, adjusted)\n      adj[i] = Math.min(1, minSoFar)\n    }\n    return adj\n  }\n\n  throw new Error(`Unknown p-adjust method: ${method}`)\n}\n\n// \u2500\u2500\u2500 Descriptive utilities \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/** Sample mean. */\nexport function mean(x: readonly number[]): number {\n  if (x.length === 0) throw new Error('mean: empty array')\n  // Explicit Number() coercion guards against JS string-concatenation if TypeScript\n  // safety is bypassed (e.g. CSV-sourced data passed without type-checking).\n  return x.reduce((s, v) => s + Number(v), 0) / x.length\n}\n\n/** Sample variance (n-1 denominator). */\nexport function variance(x: readonly number[]): number {\n  if (x.length < 2) throw new Error('variance: need at least 2 observations')\n  const m = mean(x)\n  // If the mean is non-finite (e.g. any value is Infinity), return NaN explicitly\n  // rather than letting Infinity - Infinity produce an opaque NaN mid-loop.\n  if (!isFinite(m)) return NaN\n  return x.reduce((s, v) => s + (v - m) ** 2, 0) / (x.length - 1)\n}\n\n/** Sample standard deviation. */\nexport function sd(x: readonly number[]): number {\n  return Math.sqrt(variance(x))\n}\n\n/** Standard error of the mean. */\nexport function se(x: readonly number[]): number {\n  return sd(x) / Math.sqrt(x.length)\n}\n\n/** Median. */\nexport function median(x: readonly number[]): number {\n  if (x.length === 0) throw new Error('median: empty array')\n  const sorted = [...x].sort((a, b) => a - b)\n  const mid = Math.floor(sorted.length / 2)\n  return sorted.length % 2 === 0\n    ? ((sorted[mid - 1]! + sorted[mid]!) / 2)\n    : sorted[mid]!\n}\n\n/** Quantile (using linear interpolation, same as R type=7). */\nexport function quantile(x: readonly number[], p: number): number {\n  if (p < 0 || p > 1) throw new Error(`quantile: p must be in [0,1], got ${p}`)\n  const sorted = [...x].sort((a, b) => a - b)\n  const n = sorted.length\n  const h = (n - 1) * p\n  const lo = Math.floor(h)\n  const hi = Math.ceil(h)\n  if (lo === hi) return sorted[lo]!\n  return sorted[lo]! + (h - lo) * (sorted[hi]! - sorted[lo]!)\n}\n\n/** Sort array ascending (returns new array). */\nexport function sortAsc(x: readonly number[]): number[] {\n  return [...x].sort((a, b) => a - b)\n}\n\n/** Sum of squared deviations from mean. */\nexport function ss(x: readonly number[]): number {\n  const m = mean(x)\n  return x.reduce((s, v) => s + (v - m) ** 2, 0)\n}\n\n/** Ranks (average ties), 1-indexed. */\nexport function rank(x: readonly number[]): number[] {\n  const n = x.length\n  const order = x.map((v, i) => ({ v, i })).sort((a, b) => a.v - b.v)\n  const ranks = new Array<number>(n)\n\n  let i = 0\n  while (i < n) {\n    let j = i\n    while (j < n && order[j]!.v === order[i]!.v) j++\n    const avgRank = (i + j - 1) / 2 + 1\n    for (let k = i; k < j; k++) ranks[order[k]!.i] = avgRank\n    i = j\n  }\n  return ranks\n}\n\n/** Covariance between two arrays (n-1 denominator). */\nexport function cov(x: readonly number[], y: readonly number[]): number {\n  if (x.length !== y.length) throw new Error('cov: arrays must have equal length')\n  if (x.length < 2) throw new Error('cov: need at least 2 observations')\n  const mx = mean(x), my = mean(y)\n  return x.reduce((s, v, i) => s + (v - mx) * ((y[i] ?? 0) - my), 0) / (x.length - 1)\n}\n\n/** Clamp a number to [lo, hi]. */\nexport function clamp(v: number, lo: number, hi: number): number {\n  return Math.max(lo, Math.min(hi, v))\n}\n\n/** Round to n decimal places. */\nexport function roundTo(v: number, n: number): number {\n  const factor = 10 ** n\n  return Math.round(v * factor) / factor\n}\n\n// \u2500\u2500\u2500 Studentized Range Distribution (ptukey) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/**\n * Standard normal PDF.\n */\nfunction normalPDF(z: number): number {\n  return Math.exp(-0.5 * z * z) / Math.sqrt(2 * Math.PI)\n}\n\n/**\n * CDF of the studentized range distribution P(Q \u2264 q | k, df).\n *\n * Uses multi-interval Gauss-Legendre quadrature over the variable\n * v = 2\u03C7\u00B2/df which has density Gamma(df/2, rate=df/4) with mean=2.\n * The integral: P(Q \u2264 q | k, df) = \u222B_0^\u221E f_v(v) \u00B7 P_\u221E(q\u00B7\u221A(v/2)) dv\n *\n * Follows R's Copenhaver & Holland (1988) approach: adaptive subinterval\n * widths based on df, 16-point Gauss-Legendre per subinterval.\n *\n * Reference: Copenhaver & Holland (1988), JRSS-B 50:36-45;\n * R source code src/nmath/ptukey.c\n */\nexport function ptukeyApprox(q: number, k: number, df: number): number {\n  if (q <= 0) return 0\n  if (!isFinite(q) || isNaN(q)) return NaN\n  if (k < 2) return NaN\n\n  // For very large df, use the normal (df=\u221E) case directly\n  if (df > 5000) return ptukeyInfDf(q, k)\n\n  // Determine subinterval width based on df (narrower for larger df\n  // so the chi-square peak near v=2 is adequately resolved)\n  let wStep: number\n  if (df <= 100) wStep = 1.0\n  else if (df <= 800) wStep = 0.5\n  else if (df <= 5000) wStep = 0.25\n  else wStep = 0.125\n\n  // Density of v = 2\u03C7\u00B2/df: v ~ Gamma(shape=df/2, rate=df/4)\n  // f_v(v) = (df/4)^(df/2) / Gamma(df/2) \u00B7 v^(df/2-1) \u00B7 exp(-df\u00B7v/4)\n  // Mean=2, Variance=8/df\n  const halfDf = df / 2\n  const rate = df / 4\n  const logNorm = halfDf * Math.log(rate) - logGamma(halfDf)\n\n  // 16-point Gauss-Legendre per subinterval (matches R)\n  const glPts = 16\n  const gl = gaussLegendreRef(glPts)\n\n  let result = 0\n  let vLo = 0\n\n  // Integrate subintervals until contribution is negligible\n  for (let interval = 0; interval < 200; interval++) {\n    const vHi = vLo + wStep\n    const mid = (vLo + vHi) / 2\n    const half = (vHi - vLo) / 2\n\n    let subResult = 0\n    for (let i = 0; i < glPts; i++) {\n      const v = mid + half * gl.nodes[i]!\n      const w = half * gl.weights[i]!\n      if (v <= 0) continue\n\n      // Gamma(df/2, rate=df/4) density\n      const logDens = logNorm + (halfDf - 1) * Math.log(v) - rate * v\n      const dens = Math.exp(logDens)\n      if (dens < 1e-300) continue\n\n      // P_\u221E(q \u00B7 \u221A(v/2))  where \u221A(v/2) = \u221A(\u03C7\u00B2/df)\n      const scaledQ = q * Math.sqrt(v / 2)\n      const pInf = ptukeyInfDf(scaledQ, k)\n\n      subResult += w * dens * pInf\n    }\n\n    result += subResult\n    vLo = vHi\n\n    // Stop when this subinterval contributed negligibly AND we're past the peak\n    if (vLo > 2 && Math.abs(subResult) < 1e-10) break\n  }\n\n  return Math.max(0, Math.min(1, result))\n}\n\n/**\n * CDF of studentized range for df = \u221E (normal case).\n * P(Q \u2264 q | k, \u221E) = k * \u222B_{-\u221E}^{\u221E} \u03C6(z) * [\u03A6(z + q) - \u03A6(z)]^{k-1} dz\n *\n * Uses Gauss-Hermite quadrature for the infinite-range integral.\n */\nfunction ptukeyInfDf(q: number, k: number): number {\n  if (q <= 0) return 0\n\n  // Use Gauss-Legendre on a truncated range. \u03C6(z) is negligible for |z| > 8\n  const lo = -8\n  const hi = 8\n  const npts = 64\n\n  const { nodes, weights } = gaussLegendreAB(npts, lo, hi)\n\n  let result = 0\n  for (let i = 0; i < npts; i++) {\n    const z = nodes[i]!\n    const w = weights[i]!\n    const phi = normalPDF(z)\n    const diff = normalCDF(z + q) - normalCDF(z)\n    if (diff <= 0) continue\n    result += w * phi * Math.pow(diff, k - 1)\n  }\n\n  return Math.max(0, Math.min(1, k * result))\n}\n\n/**\n * Upper-tail p-value for studentized range distribution.\n * P(Q > q | k, df)\n */\nexport function pValueStudentizedRangeApprox(q: number, k: number, df: number): number {\n  return Math.max(0, Math.min(1, 1 - ptukeyApprox(q, k, df)))\n}\n\n// \u2500\u2500\u2500 Gauss-Legendre Quadrature Nodes & Weights \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n/**\n * Gauss-Legendre nodes and weights on [a, b].\n * Computes from [-1, 1] reference nodes via affine transformation.\n */\nfunction gaussLegendreAB(n: number, a: number, b: number): { nodes: number[]; weights: number[] } {\n  const ref = gaussLegendreRef(n)\n  const mid = (a + b) / 2\n  const half = (b - a) / 2\n  return {\n    nodes: ref.nodes.map(t => mid + half * t),\n    weights: ref.weights.map(w => half * w),\n  }\n}\n\n/**\n * Gauss-Legendre nodes and weights on [-1, 1].\n * Uses Newton iteration on Legendre polynomials.\n * Reference: Golub & Welsch (1969)\n */\nfunction gaussLegendreRef(n: number): { nodes: number[]; weights: number[] } {\n  const nodes: number[] = []\n  const weights: number[] = []\n  const m = Math.ceil(n / 2)\n\n  for (let i = 0; i < m; i++) {\n    // Initial guess from Tricomi approximation\n    let z = Math.cos(Math.PI * (i + 0.75) / (n + 0.5))\n\n    let pp = 0\n    for (let iter = 0; iter < 100; iter++) {\n      let p0 = 1\n      let p1 = z\n      for (let j = 2; j <= n; j++) {\n        const p2 = ((2 * j - 1) * z * p1 - (j - 1) * p0) / j\n        p0 = p1\n        p1 = p2\n      }\n      pp = n * (z * p1 - p0) / (z * z - 1)\n      const zOld = z\n      z = z - p1 / pp\n      if (Math.abs(z - zOld) < 1e-15) break\n    }\n\n    nodes.push(z)\n    nodes.push(-z)\n    const w = 2 / ((1 - z * z) * pp * pp)\n    weights.push(w)\n    weights.push(w)\n  }\n\n  // If n is odd, the center node (z=0) was added twice \u2014 fix\n  if (n % 2 === 1) {\n    nodes.pop()\n    weights.pop()\n  }\n\n  return { nodes, weights }\n}\n", "/**\n * APA 7th edition string formatting for statistical results.\n * Every stat function uses these formatters to produce the `formatted` string\n * that gets embedded directly into plots as subtitles/captions.\n */\n\nimport { roundTo } from './math.js'\n\n/**\n * Format a p-value in APA style.\n * < .001 \u2192 \"p < .001\"\n * otherwise \u2192 \"p = .025\" (leading zero dropped, 3 decimal places)\n */\nexport function formatP(p: number): string {\n  if (p < 0.001) return 'p < .001'\n  const rounded = roundTo(p, 3).toFixed(3).replace('0.', '.')\n  return `p = ${rounded}`\n}\n\n/**\n * Format a statistic value: 2 decimal places, no leading zero for absolute values.\n * Used for t, F, z, \u03C7\u00B2, etc.\n */\nexport function formatStat(v: number, decimals = 2): string {\n  return roundTo(v, decimals).toFixed(decimals)\n}\n\n/**\n * Format a confidence interval: [lo, hi] \u2192 \"[0.08, 1.22]\"\n */\nexport function formatCI(ci: readonly [number, number], decimals = 2): string {\n  return `[${roundTo(ci[0], decimals).toFixed(decimals)}, ${roundTo(ci[1], decimals).toFixed(decimals)}]`\n}\n\n/**\n * Format degrees of freedom \u2014 integer if whole number, else 2 decimal places.\n */\nexport function formatDF(df: number | readonly [number, number]): string {\n  if (typeof df === 'number') {\n    return Number.isInteger(df) ? String(df) : df.toFixed(2)\n  }\n  const [df1, df2] = df\n  const f1 = Number.isInteger(df1) ? String(df1) : df1.toFixed(2)\n  const f2 = Number.isInteger(df2) ? String(df2) : df2.toFixed(2)\n  return `${f1}, ${f2}`\n}\n\n/**\n * Full APA string for a t-test result.\n * e.g. \"t(48) = 2.31, p = .025, d = 0.65, 95% CI [0.08, 1.22]\"\n */\nexport function formatTTest(\n  t: number,\n  df: number,\n  pValue: number,\n  effectSize: number,\n  effectName: string,\n  ci: readonly [number, number],\n  ciLevel = 0.95\n): string {\n  const ciPct = Math.round(ciLevel * 100)\n  return `t(${formatDF(df)}) = ${formatStat(t)}, ${formatP(pValue)}, ${effectName} = ${formatStat(effectSize)}, ${ciPct}% CI ${formatCI(ci)}`\n}\n\n/**\n * Full APA string for ANOVA.\n * e.g. \"F(2, 87) = 4.21, p = .018, \u03B7\u00B2 = 0.09\"\n */\nexport function formatANOVA(\n  F: number,\n  df1: number,\n  df2: number,\n  pValue: number,\n  effectSize: number,\n  effectName = '\u03B7\u00B2'\n): string {\n  return `F(${formatDF([df1, df2])}) = ${formatStat(F)}, ${formatP(pValue)}, ${effectName} = ${formatStat(effectSize)}`\n}\n\n/**\n * Full APA string for chi-square test.\n * e.g. \"\u03C7\u00B2(3) = 8.46, p = .037, V = 0.29\"\n */\nexport function formatChiSq(\n  chiSq: number,\n  df: number,\n  pValue: number,\n  effectSize: number,\n  effectName = \"V\"\n): string {\n  return `\u03C7\u00B2(${formatDF(df)}) = ${formatStat(chiSq)}, ${formatP(pValue)}, ${effectName} = ${formatStat(effectSize)}`\n}\n\n/**\n * APA string for Pearson/Spearman/Kendall correlation.\n * e.g. \"r(48) = 0.54, p = .003, 95% CI [0.28, 0.73]\"\n */\nexport function formatCorrelation(\n  r: number,\n  df: number,\n  pValue: number,\n  ci: readonly [number, number],\n  method = 'r',\n  ciLevel = 0.95\n): string {\n  const ciPct = Math.round(ciLevel * 100)\n  return `${method}(${formatDF(df)}) = ${formatStat(r)}, ${formatP(pValue)}, ${ciPct}% CI ${formatCI(ci)}`\n}\n\n/**\n * APA string for linear regression.\n * e.g. \"R\u00B2 = 0.42, F(3, 96) = 23.2, p < .001\"\n */\nexport function formatRegression(\n  r2: number,\n  adjR2: number,\n  F: number,\n  df1: number,\n  df2: number,\n  pValue: number\n): string {\n  return `R\u00B2 = ${formatStat(r2)}, adj. R\u00B2 = ${formatStat(adjR2)}, F(${formatDF([df1, df2])}) = ${formatStat(F)}, ${formatP(pValue)}`\n}\n\n/**\n * APA string for Mann-Whitney / Wilcoxon.\n * e.g. \"W = 423, p = .031, r = 0.27\"\n */\nexport function formatMannWhitney(\n  W: number,\n  pValue: number,\n  r: number\n): string {\n  return `W = ${formatStat(W, 0)}, ${formatP(pValue)}, r = ${formatStat(r)}`\n}\n\n/**\n * APA string for Kruskal-Wallis.\n * e.g. \"H(2) = 12.3, p = .002, \u03B7\u00B2_H = 0.18\"\n */\nexport function formatKruskalWallis(\n  H: number,\n  df: number,\n  pValue: number,\n  etaSq: number\n): string {\n  return `H(${formatDF(df)}) = ${formatStat(H)}, ${formatP(pValue)}, \u03B7\u00B2_H = ${formatStat(etaSq)}`\n}\n\n/**\n * APA string for LMM.\n * e.g. \"ICC = 0.42, AIC = 1234.5\"\n */\nexport function formatLMM(icc: number, aic: number, bic: number, logLik: number): string {\n  return `ICC = ${formatStat(icc)}, AIC = ${formatStat(aic, 1)}, BIC = ${formatStat(bic, 1)}, logLik = ${formatStat(logLik, 1)}`\n}\n\n/**\n * Interpret Cohen's d effect size.\n */\nexport function interpretCohensD(d: number): string {\n  const abs = Math.abs(d)\n  if (abs < 0.2) return 'negligible'\n  if (abs < 0.5) return 'small'\n  if (abs < 0.8) return 'medium'\n  return 'large'\n}\n\n/**\n * Interpret eta-squared / omega-squared.\n */\nexport function interpretEtaSq(eta: number): string {\n  if (eta < 0.01) return 'negligible'\n  if (eta < 0.06) return 'small'\n  if (eta < 0.14) return 'medium'\n  return 'large'\n}\n\n/**\n * Interpret Pearson r.\n */\nexport function interpretR(r: number): string {\n  const abs = Math.abs(r)\n  if (abs < 0.1) return 'negligible'\n  if (abs < 0.3) return 'small'\n  if (abs < 0.5) return 'medium'\n  if (abs < 0.7) return 'large'\n  return 'very large'\n}\n\n/**\n * Interpret Cram\u00E9r's V.\n */\nexport function interpretCramerV(v: number, df: number): string {\n  // Benchmarks depend on df (Cohen 1988 adjusted for contingency tables)\n  const small = df === 1 ? 0.1 : df === 2 ? 0.07 : 0.06\n  const medium = df === 1 ? 0.3 : df === 2 ? 0.21 : 0.17\n  if (v < small) return 'negligible'\n  if (v < medium) return 'small'\n  if (v < medium * 1.5) return 'medium'\n  return 'large'\n}\n\nimport type { EffectInterpretation, FactorFit } from './types.js'\n\n/**\n * APA string for CFA/EFA fit indices.\n * e.g. \"\u03C7\u00B2(24) = 28.42, p = .241, RMSEA = 0.042 [0.000, 0.085], CFI = 0.987, TLI = 0.982, SRMR = 0.038\"\n */\nexport function formatCFAFit(fit: FactorFit): string {\n  return `\u03C7\u00B2(${formatDF(fit.df)}) = ${formatStat(fit.chiSq)}, ${formatP(fit.pValue)}, RMSEA = ${formatStat(fit.rmsea, 3)} ${formatCI(fit.rmseaCI, 3)}, CFI = ${formatStat(fit.cfi, 3)}, TLI = ${formatStat(fit.tli, 3)}, SRMR = ${formatStat(fit.srmr, 3)}`\n}\n\n/** Generic effect size interpretation helper. */\nexport function interpretEffect(value: number, thresholds: readonly [number, number, number]): EffectInterpretation {\n  const abs = Math.abs(value)\n  if (abs < thresholds[0]) return 'negligible'\n  if (abs < thresholds[1]) return 'small'\n  if (abs < thresholds[2]) return 'medium'\n  return 'large'\n}\n"],
  "mappings": "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",
  "names": ["rank", "i"]
}
